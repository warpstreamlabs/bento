---
title: gcp_spanner_cdc
slug: gcp_spanner_cdc
type: input
status: stable
categories: ["Services","GCP"]
---

<!--
     THIS FILE IS AUTOGENERATED!

     To make changes please edit the corresponding source file under internal/impl/<provider>.
-->

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

Consumes spanner Change Stream Events from a GCP Spanner instance.

```yml
# Config fields, showing default values
input:
  label: ""
  gcp_spanner_cdc:
    spanner_dsn: projects/{projectId}/instances/{instanceId}/databases/{databaseName} # No default (required)
    spanner_metadata_dsn: projects/{projectId}/instances/{instanceId}/databases/{databaseName} # No default (required)
    metadata_table: table_metadata # No default (required)
    heartbeat_interval: 3s
    start_time: 2006-01-02T15:04:05Z07:00 # No default (optional)
    end_time: 2006-01-02T15:04:05Z07:00 # No default (optional)
```

For information on how to set up credentials check out [this guide](https://cloud.google.com/docs/authentication/production).

This Input uses [screamer](https://github.com/anicoll/screamer) for the reading and tracking of partitions within spanner.\
Currently does not support Postgresql Dialect for the Spanner CDC.\
It does support multiple runners using a distributed lock to ensure that only one runner is reading from a partition at a time.

### Event Data Structure
The data structure of the events emitted by this input can be found here:
* [google](https://cloud.google.com/spanner/docs/change-streams/details#data-change-records).
* [go structure](https://pkg.go.dev/github.com/anicoll/screamer#DataChangeRecord).

### Metadata

This input adds the following metadata fields to each message:

``` text
- gcp_spanner_commit_timestamp - The time the records were committed in spanner.
- gcp_spanner_cdc_mod_type - The type of modification that occurred (INSERT, UPDATE, DELETE).
- gcp_spanner_table_name - The name of the table that was modified.
- gcp_spanner_cdc_server_transaction_id - The server transaction ID of the change.
- gcp_spanner_cdc_record_sequence - The sequence number of the record in the change stream.
```



## Fields

### `spanner_dsn`

The dsn for spanner from where to read the changestream.


Type: `string`  

```yml
# Examples

spanner_dsn: projects/{projectId}/instances/{instanceId}/databases/{databaseName}
```

### `spanner_metadata_dsn`

The dsn for the metadata table to track partition reads. (can be same as spanner_dsn)


Type: `string`  

```yml
# Examples

spanner_metadata_dsn: projects/{projectId}/instances/{instanceId}/databases/{databaseName}
```

### `metadata_table`

The table name you want to use for tracking partition metadata.


Type: `string`  

```yml
# Examples

metadata_table: table_metadata

metadata_table: stream_metadata
```

### `heartbeat_interval`

An optional field to configure the heartbeat interval for partitions.


Type: `string`  
Default: `"3s"`  

### `start_time`

An optional field to define the start point to read from the changestreams, for details on valid start times please see [this document](https://cloud.google.com/spanner/docs/change-streams#data-retention)


Type: `string`  

```yml
# Examples

start_time: 2006-01-02T15:04:05Z07:00
```

### `end_time`

An optional field to define the end time to read from the changestreams


Type: `string`  

```yml
# Examples

end_time: 2006-01-02T15:04:05Z07:00
```


